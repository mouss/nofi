'use strict';

var Utils = require('../utils');
var Vue = require('vue');

function createApp(script) {
    return new Vue(script);
}

function layoutUtil(component) {
    var layout = {};
    layout.style = '';
    layout.script = component.script;
    if (component.style.length > 0) {
        layout.style += component.style;
    }
    return layout;
}

function renderedScript(script, router) {
    var routerString = router !== undefined ? 'const __router = new VueRouter(' + Utils.scriptToString(router) + ');' : '';
    var scriptString = Utils.scriptToString(script);
    var debugToolsString = '';

    if (router !== undefined) {
        scriptString = scriptString.substr(0, 1) + 'router: __router,' + scriptString.substr(1);
    }
    if (process.env.VUE_DEV) {
        debugToolsString = 'Vue.config.devtools = true;';
    }
    return '<script>\n(function () {\'use strict\';' + routerString + 'var createApp = function () {return new Vue(' + scriptString + ')};if (typeof module !== \'undefined\' && module.exports) {module.exports = createApp} else {this.app = createApp()}}).call(this);' + debugToolsString + 'app.$mount(\'#app\');\n</script>';
}

function renderHtmlUtil(component) {
    var layout = layoutUtil(component);
    var renderedScriptString = renderedScript(layout.script);
    var app = createApp(layout.script);

    return {
        app: app,
        scriptString: renderedScriptString,
        layout: layout,
        scriptStringRaw: Utils.scriptToString(layout.script)
    };
}

module.exports.layoutUtil = layoutUtil;
module.exports.renderHtmlUtil = renderHtmlUtil;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9yZW5kZXJlci9yZW5kZXIuanMiXSwibmFtZXMiOlsiVXRpbHMiLCJyZXF1aXJlIiwiVnVlIiwiY3JlYXRlQXBwIiwic2NyaXB0IiwibGF5b3V0VXRpbCIsImNvbXBvbmVudCIsImxheW91dCIsInN0eWxlIiwibGVuZ3RoIiwicmVuZGVyZWRTY3JpcHQiLCJyb3V0ZXIiLCJyb3V0ZXJTdHJpbmciLCJ1bmRlZmluZWQiLCJzY3JpcHRUb1N0cmluZyIsInNjcmlwdFN0cmluZyIsImRlYnVnVG9vbHNTdHJpbmciLCJzdWJzdHIiLCJwcm9jZXNzIiwiZW52IiwiVlVFX0RFViIsInJlbmRlckh0bWxVdGlsIiwicmVuZGVyZWRTY3JpcHRTdHJpbmciLCJhcHAiLCJzY3JpcHRTdHJpbmdSYXciLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUNBLElBQU1BLFFBQVFDLFFBQVEsVUFBUixDQUFkO0FBQ0EsSUFBTUMsTUFBTUQsUUFBUSxLQUFSLENBQVo7O0FBRUEsU0FBU0UsU0FBVCxDQUFtQkMsTUFBbkIsRUFBMkI7QUFDdkIsV0FBTyxJQUFJRixHQUFKLENBQVFFLE1BQVIsQ0FBUDtBQUNIOztBQUVELFNBQVNDLFVBQVQsQ0FBb0JDLFNBQXBCLEVBQXVDO0FBQ25DLFFBQUlDLFNBQVMsRUFBYjtBQUNBQSxXQUFPQyxLQUFQLEdBQWUsRUFBZjtBQUNBRCxXQUFPSCxNQUFQLEdBQWdCRSxVQUFVRixNQUExQjtBQUNBLFFBQUlFLFVBQVVFLEtBQVYsQ0FBZ0JDLE1BQWhCLEdBQXlCLENBQTdCLEVBQWdDO0FBQzVCRixlQUFPQyxLQUFQLElBQWdCRixVQUFVRSxLQUExQjtBQUNIO0FBQ0QsV0FBT0QsTUFBUDtBQUNIOztBQUdELFNBQVNHLGNBQVQsQ0FBd0JOLE1BQXhCLEVBQXdDTyxNQUF4QyxFQUF3RDtBQUNwRCxRQUFNQyxlQUFlRCxXQUFXRSxTQUFYLHVDQUF5RGIsTUFBTWMsY0FBTixDQUFxQkgsTUFBckIsQ0FBekQsVUFBNEYsRUFBakg7QUFDQSxRQUFJSSxlQUFlZixNQUFNYyxjQUFOLENBQXFCVixNQUFyQixDQUFuQjtBQUNBLFFBQUlZLG1CQUFtQixFQUF2Qjs7QUFFQSxRQUFJTCxXQUFXRSxTQUFmLEVBQTBCO0FBQ3RCRSx1QkFBZUEsYUFBYUUsTUFBYixDQUFvQixDQUFwQixFQUF1QixDQUF2QixJQUE0QixtQkFBNUIsR0FBa0RGLGFBQWFFLE1BQWIsQ0FBb0IsQ0FBcEIsQ0FBakU7QUFDSDtBQUNELFFBQUlDLFFBQVFDLEdBQVIsQ0FBWUMsT0FBaEIsRUFBeUI7QUFDckJKLDJCQUFtQiw2QkFBbkI7QUFDSDtBQUNELHVEQUErQ0osWUFBL0Msb0RBQTBHRyxZQUExRywwSUFBeVBDLGdCQUF6UDtBQUNIOztBQVNELFNBQVNLLGNBQVQsQ0FBd0JmLFNBQXhCLEVBQXlEO0FBQ3JELFFBQU1DLFNBQVNGLFdBQVdDLFNBQVgsQ0FBZjtBQUNBLFFBQU1nQix1QkFBdUJaLGVBQWVILE9BQU9ILE1BQXRCLENBQTdCO0FBQ0EsUUFBTW1CLE1BQU1wQixVQUFVSSxPQUFPSCxNQUFqQixDQUFaOztBQUVBLFdBQU87QUFDSG1CLGFBQUtBLEdBREY7QUFFSFIsc0JBQWNPLG9CQUZYO0FBR0hmLGdCQUFRQSxNQUhMO0FBSUhpQix5QkFBaUJ4QixNQUFNYyxjQUFOLENBQXFCUCxPQUFPSCxNQUE1QjtBQUpkLEtBQVA7QUFNSDs7QUFFRHFCLE9BQU9DLE9BQVAsQ0FBZXJCLFVBQWYsR0FBNEJBLFVBQTVCO0FBQ0FvQixPQUFPQyxPQUFQLENBQWVMLGNBQWYsR0FBZ0NBLGNBQWhDIiwiZmlsZSI6InJlbmRlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIEBmbG93XG5jb25zdCBVdGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJyk7XG5jb25zdCBWdWUgPSByZXF1aXJlKCd2dWUnKTtcblxuZnVuY3Rpb24gY3JlYXRlQXBwKHNjcmlwdCkge1xuICAgIHJldHVybiBuZXcgVnVlKHNjcmlwdCk7XG59XG5cbmZ1bmN0aW9uIGxheW91dFV0aWwoY29tcG9uZW50OiBPYmplY3QpIHtcbiAgICBsZXQgbGF5b3V0ID0ge307XG4gICAgbGF5b3V0LnN0eWxlID0gJyc7XG4gICAgbGF5b3V0LnNjcmlwdCA9IGNvbXBvbmVudC5zY3JpcHQ7XG4gICAgaWYgKGNvbXBvbmVudC5zdHlsZS5sZW5ndGggPiAwKSB7XG4gICAgICAgIGxheW91dC5zdHlsZSArPSBjb21wb25lbnQuc3R5bGU7XG4gICAgfVxuICAgIHJldHVybiBsYXlvdXQ7XG59XG5cblxuZnVuY3Rpb24gcmVuZGVyZWRTY3JpcHQoc2NyaXB0OiBPYmplY3QsIHJvdXRlcik6IHN0cmluZyB7XG4gICAgY29uc3Qgcm91dGVyU3RyaW5nID0gcm91dGVyICE9PSB1bmRlZmluZWQgPyBgY29uc3QgX19yb3V0ZXIgPSBuZXcgVnVlUm91dGVyKCR7VXRpbHMuc2NyaXB0VG9TdHJpbmcocm91dGVyKX0pO2AgOiAnJztcbiAgICBsZXQgc2NyaXB0U3RyaW5nID0gVXRpbHMuc2NyaXB0VG9TdHJpbmcoc2NyaXB0KTtcbiAgICBsZXQgZGVidWdUb29sc1N0cmluZyA9ICcnO1xuXG4gICAgaWYgKHJvdXRlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHNjcmlwdFN0cmluZyA9IHNjcmlwdFN0cmluZy5zdWJzdHIoMCwgMSkgKyAncm91dGVyOiBfX3JvdXRlciwnICsgc2NyaXB0U3RyaW5nLnN1YnN0cigxKTtcbiAgICB9XG4gICAgaWYgKHByb2Nlc3MuZW52LlZVRV9ERVYpIHtcbiAgICAgICAgZGVidWdUb29sc1N0cmluZyA9ICdWdWUuY29uZmlnLmRldnRvb2xzID0gdHJ1ZTsnO1xuICAgIH1cbiAgICByZXR1cm4gYDxzY3JpcHQ+XFxuKGZ1bmN0aW9uICgpIHsndXNlIHN0cmljdCc7JHtyb3V0ZXJTdHJpbmd9dmFyIGNyZWF0ZUFwcCA9IGZ1bmN0aW9uICgpIHtyZXR1cm4gbmV3IFZ1ZSgke3NjcmlwdFN0cmluZ30pfTtpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHttb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZUFwcH0gZWxzZSB7dGhpcy5hcHAgPSBjcmVhdGVBcHAoKX19KS5jYWxsKHRoaXMpOyR7ZGVidWdUb29sc1N0cmluZ31hcHAuJG1vdW50KCcjYXBwJyk7XFxuPC9zY3JpcHQ+YDtcbn1cblxudHlwZSBodG1sVXRpbFR5cGUgPSB7XG4gICAgYXBwOiBPYmplY3QsXG4gICAgc2NyaXB0U3RyaW5nOiBzdHJpbmcsXG4gICAgbGF5b3V0OiBPYmplY3QsXG4gICAgc2NyaXB0U3RyaW5nUmF3OiBzdHJpbmdcbn07XG5cbmZ1bmN0aW9uIHJlbmRlckh0bWxVdGlsKGNvbXBvbmVudDogT2JqZWN0KTogaHRtbFV0aWxUeXBlIHtcbiAgICBjb25zdCBsYXlvdXQgPSBsYXlvdXRVdGlsKGNvbXBvbmVudCk7XG4gICAgY29uc3QgcmVuZGVyZWRTY3JpcHRTdHJpbmcgPSByZW5kZXJlZFNjcmlwdChsYXlvdXQuc2NyaXB0KTtcbiAgICBjb25zdCBhcHAgPSBjcmVhdGVBcHAobGF5b3V0LnNjcmlwdCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBhcHA6IGFwcCxcbiAgICAgICAgc2NyaXB0U3RyaW5nOiByZW5kZXJlZFNjcmlwdFN0cmluZyxcbiAgICAgICAgbGF5b3V0OiBsYXlvdXQsXG4gICAgICAgIHNjcmlwdFN0cmluZ1JhdzogVXRpbHMuc2NyaXB0VG9TdHJpbmcobGF5b3V0LnNjcmlwdClcbiAgICB9O1xufVxuXG5tb2R1bGUuZXhwb3J0cy5sYXlvdXRVdGlsID0gbGF5b3V0VXRpbDtcbm1vZHVsZS5leHBvcnRzLnJlbmRlckh0bWxVdGlsID0gcmVuZGVySHRtbFV0aWw7XG4iXX0=